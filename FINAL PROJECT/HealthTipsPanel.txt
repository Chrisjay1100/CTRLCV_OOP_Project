package ui.customer;

import java.awt.*;
import java.awt.event.*;
import java.io.IOException;
import java.net.URI;
import java.net.URISyntaxException;
import javax.swing.*;
import javax.swing.border.EmptyBorder;

/**
 * HealthTipsPanel provides health tips, FAQs, and information about common illnesses
 * with verified links to health organizations, research, and medical sources.
 */
public class HealthTipsPanel extends JPanel {

    public HealthTipsPanel() {
        setLayout(new BorderLayout());
        setOpaque(false);
        setBorder(new EmptyBorder(30, 60, 30, 60));

        // Main scrollable container
        JPanel mainContent = new JPanel();
        mainContent.setLayout(new BoxLayout(mainContent, BoxLayout.Y_AXIS));
        mainContent.setOpaque(false);

        // Title
        JLabel titleLabel = new JLabel("Health Tips & Information", SwingConstants.CENTER);
        titleLabel.setFont(new Font("Segoe UI", Font.BOLD, 36));
        titleLabel.setForeground(Color.WHITE);
        titleLabel.setAlignmentX(Component.CENTER_ALIGNMENT);
        titleLabel.setBorder(new EmptyBorder(0, 0, 30, 0));
        mainContent.add(titleLabel);

        // Health Tips Section
        mainContent.add(createHealthTipsSection());
        mainContent.add(Box.createVerticalStrut(30));

        // FAQ Section
        mainContent.add(createFAQSection());
        mainContent.add(Box.createVerticalStrut(30));

        // Common Illnesses Section
        mainContent.add(createCommonIllnessesSection());

        // Scroll pane
        JScrollPane scrollPane = new JScrollPane(mainContent);
        scrollPane.setOpaque(false);
        scrollPane.getViewport().setOpaque(false);
        scrollPane.setBorder(new EmptyBorder(0, 0, 0, 0));
        scrollPane.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED);

        add(scrollPane, BorderLayout.CENTER);
    }

    private JPanel createHealthTipsSection() {
        JPanel section = new JPanel();
        section.setLayout(new BoxLayout(section, BoxLayout.Y_AXIS));
        section.setOpaque(false);
        section.setBorder(BorderFactory.createCompoundBorder(
            BorderFactory.createLineBorder(new Color(255, 255, 255, 100), 2),
            new EmptyBorder(20, 20, 20, 20)
        ));

        JLabel sectionTitle = new JLabel("üí° Health Tips");
        sectionTitle.setFont(new Font("Segoe UI", Font.BOLD, 24));
        sectionTitle.setForeground(new Color(200, 220, 255));
        sectionTitle.setAlignmentX(Component.LEFT_ALIGNMENT);
        section.add(sectionTitle);
        section.add(Box.createVerticalStrut(15));

        String[][] tips = {
            {
                "Stay Hydrated",
                "Drink at least 8 glasses of water daily to maintain proper body function.",
                "https://www.cdc.gov/nutrition/data-statistics/plain-water-the-healthier-choice.html"
            },
            {
                "Regular Exercise",
                "Aim for at least 150 minutes of moderate-intensity exercise per week.",
                "https://www.who.int/news-room/fact-sheets/detail/physical-activity"
            },
            {
                "Balanced Diet",
                "Eat a variety of fruits, vegetables, whole grains, and lean proteins.",
                "https://www.hsph.harvard.edu/nutritionsource/healthy-eating-plate/"
            },
            {
                "Adequate Sleep",
                "Get 7-9 hours of quality sleep each night for optimal health.",
                "https://www.sleepfoundation.org/how-sleep-works/how-much-sleep-do-we-really-need"
            },
            {
                "Stress Management",
                "Practice relaxation techniques like meditation or deep breathing.",
                "https://www.nimh.nih.gov/health/publications/stress"
            }
        };

        for (String[] tip : tips) {
            section.add(createTipItem(tip[0], tip[1], tip[2]));
            section.add(Box.createVerticalStrut(10));
        }

        return section;
    }

    private JPanel createFAQSection() {
        JPanel section = new JPanel();
        section.setLayout(new BoxLayout(section, BoxLayout.Y_AXIS));
        section.setOpaque(false);
        section.setBorder(BorderFactory.createCompoundBorder(
            BorderFactory.createLineBorder(new Color(255, 255, 255, 100), 2),
            new EmptyBorder(20, 20, 20, 20)
        ));

        JLabel sectionTitle = new JLabel("‚ùì Frequently Asked Questions");
        sectionTitle.setFont(new Font("Segoe UI", Font.BOLD, 24));
        sectionTitle.setForeground(new Color(200, 220, 255));
        sectionTitle.setAlignmentX(Component.LEFT_ALIGNMENT);
        section.add(sectionTitle);
        section.add(Box.createVerticalStrut(15));

        String[][] faqs = {
            {
                "What should I do if I have a fever?",
                "Rest, stay hydrated, and monitor your temperature. If fever persists or is above 103¬∞F, consult a healthcare provider.",
                "https://www.mayoclinic.org/diseases-conditions/fever/symptoms-causes/syc-20352759"
            },
            {
                "How often should I get a health checkup?",
                "Adults should have annual checkups. Those with chronic conditions may need more frequent visits.",
                "https://www.cdc.gov/prevention/index.html"
            },
            {
                "What are the signs of dehydration?",
                "Symptoms include dry mouth, dark urine, fatigue, and dizziness. Drink water immediately if experiencing these.",
                "https://www.mayoclinic.org/diseases-conditions/dehydration/symptoms-causes/syc-20354086"
            },
            {
                "When should I see a doctor?",
                "Seek medical attention for persistent symptoms, severe pain, difficulty breathing, or any emergency situation.",
                "https://www.nhs.uk/common-health-questions/nhs-services-and-treatments/when-should-i-see-a-doctor/"
            },
            {
                "How can I boost my immune system?",
                "Maintain a healthy diet, exercise regularly, get adequate sleep, manage stress, and avoid smoking.",
                "https://www.harvard.edu/in-news/how-to-boost-your-immune-system/"
            }
        };

        for (String[] faq : faqs) {
            section.add(createFAQItem(faq[0], faq[1], faq[2]));
            section.add(Box.createVerticalStrut(10));
        }

        return section;
    }

    private JPanel createCommonIllnessesSection() {
        JPanel section = new JPanel();
        section.setLayout(new BoxLayout(section, BoxLayout.Y_AXIS));
        section.setOpaque(false);
        section.setBorder(BorderFactory.createCompoundBorder(
            BorderFactory.createLineBorder(new Color(255, 255, 255, 100), 2),
            new EmptyBorder(20, 20, 20, 20)
        ));

        JLabel sectionTitle = new JLabel("üè• Common Illnesses & Diseases");
        sectionTitle.setFont(new Font("Segoe UI", Font.BOLD, 24));
        sectionTitle.setForeground(new Color(200, 220, 255));
        sectionTitle.setAlignmentX(Component.LEFT_ALIGNMENT);
        section.add(sectionTitle);
        section.add(Box.createVerticalStrut(15));

        String[][][] illnesses = {
            {
                {"Common Cold", "Symptoms: Runny nose, sneezing, sore throat"},
                {"What to do:", "Rest, stay hydrated, use over-the-counter remedies for symptoms"},
                {"Self-care:", "Gargle with salt water, use a humidifier, get plenty of rest"},
                {"Verified Sources:", 
                    "CDC: https://www.cdc.gov/antibiotic-use/colds.html",
                    "Mayo Clinic: https://www.mayoclinic.org/diseases-conditions/common-cold/symptoms-causes/syc-20351605",
                    "PubMed: https://pubmed.ncbi.nlm.nih.gov/?term=common+cold+treatment"}
            },
            {
                {"Influenza (Flu)", "Symptoms: Fever, body aches, fatigue, cough"},
                {"What to do:", "Rest, stay hydrated, take antiviral medication if prescribed early"},
                {"Self-care:", "Isolate to prevent spread, use fever reducers, maintain fluid intake"},
                {"Verified Sources:",
                    "WHO: https://www.who.int/news-room/fact-sheets/detail/influenza-(seasonal)",
                    "CDC: https://www.cdc.gov/flu/index.htm",
                    "Google Scholar: https://scholar.google.com/scholar?q=influenza+treatment"}
            },
            {
                {"Hypertension (High Blood Pressure)", "Symptoms: Often asymptomatic, may include headaches, shortness of breath"},
                {"What to do:", "Monitor blood pressure regularly, follow medication regimen, reduce sodium intake"},
                {"Self-care:", "Exercise regularly, maintain healthy weight, limit alcohol, manage stress"},
                {"Verified Sources:",
                    "American Heart Association: https://www.heart.org/en/health-topics/high-blood-pressure",
                    "NIH: https://www.nhlbi.nih.gov/health/high-blood-pressure",
                    "PubMed: https://pubmed.ncbi.nlm.nih.gov/?term=hypertension+management"}
            },
            {
                {"Diabetes", "Symptoms: Increased thirst, frequent urination, fatigue, blurred vision"},
                {"What to do:", "Monitor blood sugar, follow medication plan, maintain regular checkups"},
                {"Self-care:", "Follow a balanced diet, exercise regularly, monitor glucose levels"},
                {"Verified Sources:",
                    "American Diabetes Association: https://www.diabetes.org/",
                    "CDC: https://www.cdc.gov/diabetes/basics/index.html",
                    "Google Scholar: https://scholar.google.com/scholar?q=diabetes+self+management"}
            },
            {
                {"Asthma", "Symptoms: Wheezing, shortness of breath, chest tightness, coughing"},
                {"What to do:", "Use prescribed inhalers, avoid triggers, have an action plan"},
                {"Self-care:", "Identify and avoid triggers, monitor symptoms, keep rescue medication handy"},
                {"Verified Sources:",
                    "American Lung Association: https://www.lung.org/lung-health-diseases/lung-disease-lookup/asthma",
                    "NIH: https://www.nhlbi.nih.gov/health/asthma",
                    "PubMed: https://pubmed.ncbi.nlm.nih.gov/?term=asthma+management"}
            },
            {
                {"COVID-19", "Symptoms: Fever, cough, fatigue, loss of taste/smell, difficulty breathing"},
                {"What to do:", "Isolate immediately, monitor symptoms, seek medical care if severe"},
                {"Self-care:", "Rest, stay hydrated, use over-the-counter fever reducers, monitor oxygen levels"},
                {"Verified Sources:",
                    "WHO: https://www.who.int/emergencies/diseases/novel-coronavirus-2019",
                    "CDC: https://www.cdc.gov/coronavirus/2019-ncov/index.html",
                    "Google Scholar: https://scholar.google.com/scholar?q=COVID-19+treatment"}
            }
        };

        for (String[][] illness : illnesses) {
            section.add(createIllnessCard(illness));
            section.add(Box.createVerticalStrut(15));
        }

        return section;
    }

    private JPanel createTipItem(String title, String description, String link) {
        JPanel item = new JPanel();
        item.setLayout(new BoxLayout(item, BoxLayout.Y_AXIS));
        item.setOpaque(false);
        item.setAlignmentX(Component.LEFT_ALIGNMENT);

        JLabel titleLabel = new JLabel("‚Ä¢ " + title);
        titleLabel.setFont(new Font("Segoe UI", Font.BOLD, 16));
        titleLabel.setForeground(Color.WHITE);
        titleLabel.setAlignmentX(Component.LEFT_ALIGNMENT);
        item.add(titleLabel);

        JLabel descLabel = new JLabel("<html><div style='width:800px;'>" + description + "</div></html>");
        descLabel.setFont(new Font("Segoe UI", Font.PLAIN, 14));
        descLabel.setForeground(new Color(240, 240, 240));
        descLabel.setAlignmentX(Component.LEFT_ALIGNMENT);
        item.add(descLabel);

        JLabel linkLabel = createHyperlink("Learn more from verified source ‚Üí", link);
        linkLabel.setAlignmentX(Component.LEFT_ALIGNMENT);
        item.add(linkLabel);

        return item;
    }

    private JPanel createFAQItem(String question, String answer, String link) {
        JPanel item = new JPanel();
        item.setLayout(new BoxLayout(item, BoxLayout.Y_AXIS));
        item.setOpaque(false);
        item.setAlignmentX(Component.LEFT_ALIGNMENT);

        JLabel questionLabel = new JLabel("Q: " + question);
        questionLabel.setFont(new Font("Segoe UI", Font.BOLD, 16));
        questionLabel.setForeground(Color.WHITE);
        questionLabel.setAlignmentX(Component.LEFT_ALIGNMENT);
        item.add(questionLabel);

        JLabel answerLabel = new JLabel("<html><div style='width:800px;'>A: " + answer + "</div></html>");
        answerLabel.setFont(new Font("Segoe UI", Font.PLAIN, 14));
        answerLabel.setForeground(new Color(240, 240, 240));
        answerLabel.setAlignmentX(Component.LEFT_ALIGNMENT);
        item.add(answerLabel);

        JLabel linkLabel = createHyperlink("Verified source ‚Üí", link);
        linkLabel.setAlignmentX(Component.LEFT_ALIGNMENT);
        item.add(linkLabel);

        return item;
    }

    private JPanel createIllnessCard(String[][] illnessData) {
        JPanel card = new JPanel();
        card.setLayout(new BoxLayout(card, BoxLayout.Y_AXIS));
        card.setOpaque(false);
        card.setBorder(BorderFactory.createCompoundBorder(
            BorderFactory.createLineBorder(new Color(255, 255, 255, 150), 1),
            new EmptyBorder(15, 15, 15, 15)
        ));
        card.setAlignmentX(Component.LEFT_ALIGNMENT);

        // Illness name and symptoms
        JLabel nameLabel = new JLabel(illnessData[0][0]);
        nameLabel.setFont(new Font("Segoe UI", Font.BOLD, 18));
        nameLabel.setForeground(new Color(200, 220, 255));
        nameLabel.setAlignmentX(Component.LEFT_ALIGNMENT);
        card.add(nameLabel);

        JLabel symptomsLabel = new JLabel(illnessData[0][1]);
        symptomsLabel.setFont(new Font("Segoe UI", Font.ITALIC, 14));
        symptomsLabel.setForeground(new Color(220, 220, 220));
        symptomsLabel.setAlignmentX(Component.LEFT_ALIGNMENT);
        card.add(symptomsLabel);
        card.add(Box.createVerticalStrut(10));

        // What to do
        JLabel whatToDoTitle = new JLabel(illnessData[1][0]);
        whatToDoTitle.setFont(new Font("Segoe UI", Font.BOLD, 15));
        whatToDoTitle.setForeground(Color.WHITE);
        whatToDoTitle.setAlignmentX(Component.LEFT_ALIGNMENT);
        card.add(whatToDoTitle);

        JLabel whatToDoDesc = new JLabel("<html><div style='width:800px;'>" + illnessData[1][1] + "</div></html>");
        whatToDoDesc.setFont(new Font("Segoe UI", Font.PLAIN, 13));
        whatToDoDesc.setForeground(new Color(240, 240, 240));
        whatToDoDesc.setAlignmentX(Component.LEFT_ALIGNMENT);
        card.add(whatToDoDesc);
        card.add(Box.createVerticalStrut(8));

        // Self-care
        JLabel selfCareTitle = new JLabel(illnessData[2][0]);
        selfCareTitle.setFont(new Font("Segoe UI", Font.BOLD, 15));
        selfCareTitle.setForeground(Color.WHITE);
        selfCareTitle.setAlignmentX(Component.LEFT_ALIGNMENT);
        card.add(selfCareTitle);

        JLabel selfCareDesc = new JLabel("<html><div style='width:800px;'>" + illnessData[2][1] + "</div></html>");
        selfCareDesc.setFont(new Font("Segoe UI", Font.PLAIN, 13));
        selfCareDesc.setForeground(new Color(240, 240, 240));
        selfCareDesc.setAlignmentX(Component.LEFT_ALIGNMENT);
        card.add(selfCareDesc);
        card.add(Box.createVerticalStrut(10));

        // Verified Sources
        JLabel sourcesTitle = new JLabel(illnessData[3][0]);
        sourcesTitle.setFont(new Font("Segoe UI", Font.BOLD, 15));
        sourcesTitle.setForeground(new Color(255, 255, 150));
        sourcesTitle.setAlignmentX(Component.LEFT_ALIGNMENT);
        card.add(sourcesTitle);

        for (int i = 1; i < illnessData[3].length; i++) {
            String sourceLine = illnessData[3][i];
            String[] parts = sourceLine.split(": ", 2);
            if (parts.length == 2) {
                String sourceName = parts[0];
                String sourceUrl = parts[1];
                JLabel sourceLink = createHyperlink("  ‚Ä¢ " + sourceName, sourceUrl);
                sourceLink.setAlignmentX(Component.LEFT_ALIGNMENT);
                card.add(sourceLink);
            }
        }

        return card;
    }

    private JLabel createHyperlink(String text, String url) {
        JLabel linkLabel = new JLabel("<html><a href=''>" + text + "</a></html>");
        linkLabel.setForeground(new Color(150, 200, 255));
        linkLabel.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
        linkLabel.setFont(new Font("Segoe UI", Font.PLAIN, 13));

        linkLabel.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseClicked(MouseEvent e) {
                openURL(url);
            }

            @Override
            public void mouseEntered(MouseEvent e) {
                linkLabel.setForeground(new Color(200, 230, 255));
            }

            @Override
            public void mouseExited(MouseEvent e) {
                linkLabel.setForeground(new Color(150, 200, 255));
            }
        });

        return linkLabel;
    }

    private void openURL(String urlString) {
        try {
            URI uri = new URI(urlString);
            Desktop desktop = Desktop.isDesktopSupported() ? Desktop.getDesktop() : null;
            if (desktop != null && desktop.isSupported(Desktop.Action.BROWSE)) {
                desktop.browse(uri);
            } else {
                JOptionPane.showMessageDialog(this,
                    "Unable to open browser. Please visit: " + urlString,
                    "Open Link",
                    JOptionPane.INFORMATION_MESSAGE);
            }
        } catch (URISyntaxException | IOException e) {
            JOptionPane.showMessageDialog(this,
                "Error opening link: " + e.getMessage() + "\nURL: " + urlString,
                "Error",
                JOptionPane.ERROR_MESSAGE);
        }
    }
}


